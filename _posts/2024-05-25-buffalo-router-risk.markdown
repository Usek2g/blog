---
layout: post
title:  "バッファローが一部Wi-Fiルーターで脆弱性の注意喚起。対応しました"
date:   2024-05-25 13:15:27 +0900
categories: news
img: WHR-1166DHP2__0100.jpg
 # Add image post (optional)
tags: [Security] # add tag
description: バッファロー製の無線WiFiルータに脆弱性があり影響大とのこと。僕のWi-Fiルータに影響はなかったけど、念のための確認を行いました。
---

最近大きくニュースになっているこの話題を共有します。

[バッファローが一部Wi-Fiルーターで注意喚起、bot感染増加を受け　パスワード変更やファームウェア更新を](https://www.itmedia.co.jp/news/articles/2405/23/news215.html)

こちらがバッファロー公式のアナウンスです。

[NICTERの投稿に関する重要なお知らせ](https://www.buffalo.jp/news/detail/20240523-01.html)

感染の疑いのある商品シリーズは以下になります。

- WHR-1166DHP2
- WHR-1166DHP3
- WHR-1166DHP4
- WSR-1166DHP3
- WSR-600DHP
- WEX-300HPTX/N
- WEX-733DHP2

バッファローのWi-Fiルーターは価格と性能のバランスが良いことから大きなシェアを獲得しています。僕の自宅のWi-Fiルータも、実家のWi-Fiルータもバッファロー製です。
自宅のルータの種類を調べたところ「WSR-1166DHPL」でした。リストには載っていませんが調べてみたところ、バッファロー公式Xのアカウントに、上記の機種は問題ないかを質問してくれた方がいました。感謝。
以下がバッファロー公式の回答です。

>WSR-1166DHPLは該当商品ではございません。しかしながらお手すきの際に下記3点をご確認いただければと思います。
>・ファームウェアが最新になっていることhttps://buffalo.jp/support/faq/detail/128.html
>・管理パスワードが変更されていることhttps://buffalo.jp/support/faq/detail/16077.html
>・Web設定画面の［詳細設定］－［管理］－［システム設定］にて、「Internet側リモートアクセス設定を許可する」が無効になっていること

さっそく確認してみました。

## ファームウェア最新の確認
[https://buffalo.jp/support/faq/detail/128.html](https://buffalo.jp/support/faq/detail/128.html)

上記に詳しい方法が書かれているのですが、みんな見ているせいか、

**このサイトにアクセスできませんbuffalo.jp からの応答時間が長すぎます。**

が表示されましたが、何回かやっているうちに繋がりました。
上記のサイトに丁寧に解説されていますが、自分からも改めて説明します。
WindowsPCのケースとなります。

まず、[ソフトウェア Wi-Fi(無線LAN)一覧](https://www.buffalo.jp/support/product/search/?category_id=10&type=software&bstatus=true)を開き、ルータの種類（自分の場合は"WSR-1166DHPL"）を検索ボックスに入力します。該当製品かつ該当バージョンのファームウェアをダウンロードします。該当バージョンが1.xか2.xかを判断する必要がありましたが、ページに分かりやすく書かれているように、底面のシールにv2と書かれていたら2.x系です。

 ダウンロードした「xxxxx-***.exe」を、ダブルクリックして解凍します。
 「xxxxx-***」というフォルダ（ショートカット）がデスクトップ上に作成されます。

次に、やはり公式サイトに従い、"エアステーション設定ツール"をPCにインストールします。バッファロー公式のルータを設定できるツールです。起動するとWiFiルータを自動で検索しますが、自分の場合

"2つ以上のネットワーク接続がつながっています。無線親機との通信ができなくなる場合があります"

と表示されました。怖いですね。しかし「続行」を押したところ問題なく無線親機が見つかりました。親機が見つからったら「次へ」を押して「設定画面を開く」ボタンを押しましょう。
ブラウザで192.168.11.1へとリダイレクトされます（実はこのアプリを起動しなくてもブラウザでIPアドレスを入力したら同じ画面に遷移します）。ログインIDとパスワードを入力しましょう。自分の場合は底面に書かれていたIDとパスワードでログインできましたが、書かれていない場合はログインID:admin、パスワード:passwordとのことです。

ログイン後、メニューから「管理」→「ファームウェア更新」で”ローカルファイル指定”のラジオボタンのまま、「ファイルを選択」ボタンから、先ほどデスクトップに作られたショートカットを「開く」を押すと「xxxxx-***」（xxxxxは商品名、***はバージョン番号）があるので、これを選択します。

するとバージョンアップされるとのことです。バージョンアップ中（ルータのランプが点滅）の際はルータの電源を切ってはNG。

しかしここまで書いておいて、なんで"とのこと"と書いたかというと、僕のルータは自動でファームウェアが更新される設定があるようで、府現在のファームウェアバージョン＝ダウンロードした最新のファームウェアバージョンでした(笑)ここまでの苦労は…と思いましたが、この記事が参考になれば幸いです。

## 管理パスワードが変更されていること
先ほど、デフォルトのID/PWがadmin:passwordの機種もあることを話しました。
『こんな簡単なパスワード、誰でも入れてしまうじゃないか！！』と危惧するのはもっともですが、この無線Wi-Fiルータには、Wi-Fi接続のSSIDと暗号化キーが分かる人でないと繋げられないことは知っておいてください。192.168から始まるＩＰアドレスはプライベートＩＰアドレスと呼ばれ、インターネットつまりよそのPCやスマフォからはアクセスできません。
とはいえ、万一Wi-Fiの暗号化キーがバレて家の近くから侵入されたり、家に案内した友人にWi-Fiを貸したら侵入された、なんてこともないとは言えない（とんでもない友人ですが）。のでパスワードの変更はやっておいたほうがよいです。こちらも先ほどのログイン後メニューから「管理」→「システム設定」でいけます。覚えやすいパスワードにしないようパスワード管理ツールで管理しておくと良いでしょう。今やパスワードは自身が覚えられないような複雑なものを設定して、パスワード管理ツールで管理し、定期的な変更は不要、という一昔前とは違う運用が推奨されています。

## Web設定画面の［詳細設定］－［管理］－［システム設定］にて、「Internet側リモートアクセス設定を許可する」が無効になっていること
これは書いてある通りです。確認したところ無効になっていました。おそらくデフォルトで無効なのでしょう。
VPN（Virtual Private Network）を使ってオ、フィスや外出先から自宅のWi-Fiルータ経由で自宅の起動中のPCにアクセスしたい、なんて際に使う機能かもしれませんが、一般の人はおそらくそんなシーンは無いと思いますし、リスクを増やすだけなのでこれは無効にしておくがよいでしょう。

今回僕のWi-Fiルータは脆弱性の対象外のルータでしたが、一通り問題ないことを確認しました。脆弱性あるルータもルータの初期化設定（すでにbotが混入してしまっている場合に削除する目的）後、上記と同じことをするので、この記事が参考になれば幸いです。

まあ、これは一般家庭のルータですが、企業のルータとなったら初期化設定、ファームウェア更新は一大事、その間ネットは使えませんし、下手したらネットがつながらなくなる可能性もありますからね、かといって脆弱性は放置できない・・・というような仕事を我々セキュリティ担当、インフラ担当は日々やっているわけです。ホント、たいへんです。