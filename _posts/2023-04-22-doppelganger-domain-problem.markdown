---
layout: post
title:  "ドッペルゲンガードメインにご注意を"
date:   2023-04-22 22:50:27 +0900
categories: incident
img: doppelganger.png
 # Add image post (optional)
tags: [Security] # add tag
description: セキュリティ専門家のくせにドッペルゲンガードメインに引っかかる
---

「ドッペルゲンガードメイン」という言葉をご存じでしょうか。
「ドッペルゲンガー」とは自分とうり二つな分身、もう一人の自分、遭遇すると死ぬ、なんていう話しのネタもあります。
「ドッペルゲンガードメイン」とは、有名なドメインに似た（そっくりの）ドメイン名です。amazon.co.jpではなくanazon.co.jp、gmail.comではなくgmai.comなど。これらのドメインを使って詐欺を図ったり情報を窃取するセキュリティ攻撃のことを差します。

ちなみに、ChatGPTは「ドッペルゲンガードメイン」を理解していませんw

> 「Doppelganger（ドッペルゲンガー）」とは、ドイツ語で「二重身」を意味する言葉であり、人が自分自身の幽霊的または超常現象的な姿を見る現象を指します。「Domain（ドメイン）」とは、領土または支配領域を意味します。
> ドッペルゲンガードメインの概念は、幻想文学やSF作品などで使用されるフィクションの一つであり、実際の歴史的な出来事や現象には根ざしていません。ドッペルゲンガードメインの概念は、歴史を通じて様々な文化の文学や神話で探求された二重性や、重なり合う自己像の概念に遡ることができます。
> 近年では、ドッペルゲンガードメインは、ビデオゲーム、小説、テレビ番組など、様々な形式のポピュラーメディアで使用されています。これらの作品では、ドッペルゲンガードメインは、同じ能力やスキルを持った自分自身の複製を作成することができる能力として描かれることが多いです。
> ドッペルゲンガードメインは、フィクションの概念であるにもかかわらず、自己のアイデンティティ、自己発見、神格化の結果などのテーマを探求するためのプロットデバイスとしてよく使用されます。この概念は、複雑なテーマやアイデアを探求するために作家やクリエイターに独自の方法を提供する、ファンタジーやSFジャンルの中で人気のあるトロープであると言えます。

ドッペルゲンガードメインは古典的な攻撃手法です。フィッシング詐欺の場合サイトを構築する必要はありますが、特別な技術やソフトウェアの脆弱性を必要としません。メールを利用してのドッペルゲンガードメインについては、類似したドメインを購入してメールサーバーを立てるだけです。しかし攻撃手法は巧妙化しており、最近はもはや目視では見分けがつかないドッペルゲンガードメインが使われています。

[見分けが不可能な偽サイトがGoogle検索最上位に堂々と表示されてしまう、「i」をURLに含む全てのサイトが信用できなくなる極悪手法](https://gigazine.net/news/20221101-google-dangerous/)

> Googleの検索結果をもう一度確認してみると、表示されているURLは本物と同一の「https://www.gimp.org/」に見えます。同一URLなら同じサイトにアクセスできるはずですが、上述の通り、最上部のリンクをクリックすると偽サイトにアクセスしてしまいます。この現象が発生する理由について、Redditでは「URLに含まれるアルファベットの『i(アイ)』に見える文字が、実はキリル文字の『і(イー)』なのではないか」と指摘されています

ヒューマンエラーに属するドッペルゲンガードメインですが、ヒューマンエラーが理由ゆえに防ぐことは容易ではありません。「気をつける」ではなんの対策にもなりません。前職では「メールを送る時には必ず連絡帳に登録されているメールアドレスをコピペし、手入力しない」などのルールがありましたが、はじめて送る相手のメールアドレスは連絡帳には入っていないこともあるでしょう。楽でかつ確実性がある対策が求められます。

[ドッペルゲンガードメインへのメール送信遮断について](https://netsys.hosei.ac.jp/important/important20221208k01.html)
法政大学ではよく使うドメインに類似したドメインをフィルタリングすることでメール誤送信を防ぐ施策を取っています。利用者の対策は軽いですが、一方で次から次へと生まれるドッペルゲンガードメインを逐一登録するのはたいへんそうです。GoogleやMicrosoftなどメール機能を提供している会社が悪質なドメインリストを日々収集し、フィルタリングしてくれるとありがたいのですが・・・。

[メール誤送信のリスクと対策　-ドッペルゲンガー・ドメインを踏まえて-](https://note.com/dirbato/n/n649d56ced919)
送信遅延や送信取り消し機能は対策としてはないわけではないものの、結局本人がその場で気が付かないとメールが送られてしまいます。オートコンプリート機能を停止し、手入力せずコピー＆ペーストで入力するのはそれなりに効果はあると思いますが、悪い人間のせいで便利機能を封印しなければならないのは哀しいところですね。

ドッペルゲンガードメインを防ぐ方法として自分が意識しているのは

- 新規作成メールを選択して、メールアドレスを入力する行為を避けるためにやりとりは返信orすべて返信で。
    - まったく別件なのに過去のタイトルが使われるのは不本意なのですが
- Gmailは外部組織やこれまで送ったことがないドメインのメールアドレスはアドレスに色が付くので参考に
- そもそもメールを使わず、Chatworkなど企業向けSNSでやりとりする。そもそも現代において電子メールはセキュリティ攻撃の最も大きな口となっており、コミュニケーションツールとして相応しいとは言えない

などです。参考になれば幸いです。

最後に、なぜ僕が今回この記事を書いたかというと、セキュリティの専門家である僕ですがドッペルゲンガードメインに引っかかったからです(--;)
数年ぶりに家族に電子メールを送りました。メールアドレスの打ち間違いがないよう過去の送信メールのアドレスをコピペしたのですが、なんと **数年前に送った宛先メールアドレス自体が間違っていたと** いうトホホな結果に。送信失敗のメールが返ってきてなかったことから、相手は自分ドメイン宛のすべてのメールを受信許可にしているのでしょう。幸いというか、個人情報と言えるような情報は載っていなかったものの、悪用されると困る文言が入っていたことも確かで完全なヒヤリハットです。これを仕事でやっていたらセキュリティインシデントです。家族にも話しましたが「なんでいつものようにLINEでやりとりしなかったの」まあおっしゃる通りです。皆さんもお気を付けください。